<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>The answer is 2011. The question can be brute force. - Quentin Bonnard</title>
  <meta name="author" content="Quentin Bonnard">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://quentin.bonnard.eu/blog/2011/10/25/The_answer_is_2011_the_question_can_be_brute_force">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Quentin Bonnard" type="application/atom+xml">

  <link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">


  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>
  

</head>

  <body   >
    <div id="wrap">
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <nav class="sidebar col-md-3">
    <h3><a href="/">Quentin Bonnard</a></h3>
<section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title"><a href="/contact">About</a></h3>
  </div>
    <div id="about" class="hidden-xs hidden-sm list-group">
        <a
            target="_blank"
            class="list-group-item"
            href="https://www.linkedin.com/in/quentinbonnard">
            LinkedIn
        </a>
        <a
            target="_blank"
            class="list-group-item"
            href="https://github.com/qbonnard">
            GitHub
        </a>
        <a
            class="list-group-item "
            href="/contact">
            Contact
        </a>
  </div>
</section>
<section class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title"><a href="/portfolio">Portfolio</a></h3>
    </div>
    <div id="portfolio" class="hidden-xs hidden-sm list-group">
        <a
            class="list-group-item "
            href="/portfolio/chilitags">
            Chilitags
        </a>
        <a
            class="list-group-item "
            href="/portfolio/metroscope">
            Metroscope
        </a>
        <a
            class="list-group-item "
            href="/portfolio/holographic-showcases">
            Holographic Showcases
        </a>
        <a
            class="list-group-item "
            href="/portfolio/reflect-table">
            Reflect Table
        </a>
    </div>
</section>
<section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title"><a href="/blog/archives">Blog</a></h3>
  </div>
  
  <div id="recent_posts" class="hidden-xs hidden-sm list-group">
    
    <a class="list-group-item " href="/blog/2014/03/12/ar-2048-play-with-paper/">2048 in Augmented Reality</a>
    
    <a class="list-group-item " href="/blog/2014/03/03/Yes_my_Kindle_can_do_this_Flappy_bird_on_paper/">Yes, My Kindle Can Do This: Flappy Bird on Paper</a>
    
    <a class="list-group-item " href="/blog/2013/10/16/Using-OpenCV_s_test_framework_with_CMake/">Using OpenCV's Test Framework (With CMake)</a>
    
    <a class="list-group-item " href="/blog/2011/12/18/Reverse_Literate_Programming_on_Jekyll-GitHub/">(Reverse) Literate Programming on Jekyll/Github</a>
    
    <a class="list-group-item active" href="/blog/2011/10/25/The_answer_is_2011_the_question_can_be_brute_force/">The Answer Is 2011. The Question Can Be Brute Force.</a>
    
  </div>
</section>

  </nav>

  <div class="page-content col-md-9">
    <article class="hentry" role="article">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-10-25T00:00:00+02:00" pubdate data-updated="true"></time>
        
      </p>
    
    
    <h1 class="entry-title">
        The Answer Is 2011. The Question Can Be Brute Force.
        
    </h1>
    
  </header>


<div class="entry-content clearfix"><p>This post describes a brute-force method to find that <code>(1+2)!! + 3!^4 - 5 = 2011</code> and gives an implementation in C++.</p>

<h1>The story</h1>

<p>The <a href="http://fondation.cartier.com/?_lang=en">Fondation Cartier</a> in Paris created an exhibition called <em>Mathematics &ndash; A Beautiful Elsewhere</em> and invited mathematicians and artists. Among them, <a href="http://en.wikipedia.org/wiki/Takeshi_Kitano">Takeshi Kitano</a> proposed a game called &ldquo;La réponse est 2011&rdquo; (The answer is 2011). The rules are simple:</p>

<ul>
<li>The player can use the as many number as needed, but in the natural order: 1, 2, 3, 4, 5, etc.</li>
<li>These numbers can be the operands of <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code> (power), <code>!</code> (factorial), and square root. Parenthesis can be added freely to order these operations.</li>
<li>The result should be 2011, and the formula should use as few numbers as possible.</li>
</ul>


<p>Takeshi Kitano proposed several answers, the shortest being:</p>

<p><code>(1+2+3)^4 + (5*6*7*8) – (9*10*11) + 12 + 13 = 2011</code></p>

<p>The company of Frédéric, my Ph.D. supervisor, designed the touchscreen allowing to play this game at the exhibition. Frédéric, who tells <a href="http://fkaplan.wordpress.com/2011/10/24/la-reponse-est-2011/">his side of the story</a> in his blog (in French), was warning me at a coffee break that designing an addictive game (just try it!) is actually quite dangerous. When someone realized that the given answer could be improved, the company started losing all its developers in a obsessive compulsive vortex. He also told me that the current best answer used only 6 numbers. My mission in life became clear: save my fellow nerds using brute-force. Turns out, I just ruined their happiness. I&rsquo;ll try to make up for it by sharing the fun I had (solving the problem, not ruining their happiness).</p>

<h1>Enumerating the candidates</h1>

<p>Well, the method is pretty clear: brute force means trying every possibility and checking its validity. The only tricky part is how to enumerate the candidates. This is simpler if we consider only the binary operations first, and consider factorial and square root in a second step.</p>

<p>Noting that applying one of the binary operations will leave us with one less term, we will have to apply <code>n-1</code> operations on <code>n</code> initial numbers. The orders of the initial numbers is fixed, but the parentheses allow the operation to be between any subsequent terms. In other words, the first operation has <code>n-1</code> possible pairs of operands, the second operation has <code>n-2</code>, etc. Each operation can be one of the <code>k</code> different (here <code>k = 5</code>), which gives us</p>

<p><code>(n-1)! * k^n</code></p>

<p>possibilities to try. It&rsquo;s good that &ldquo;my fellow nerds&rdquo; found that <code>n</code> does not have to be greater than <code>6</code>&hellip;</p>

<p>Now the problem is that unary operations can be applied as often as possible. They can be applied to any of the initial numbers, and to any of the results of the binary operations. However, no factorial is a square (except 1), so we can apply the square root first (as many times as we want), and then the factorial, without trying to interleave them. To be thorough, it could happen that an irrational intermediate result gets multiplied with itself, but a little bird told me that it is a lot less frequent than it would cost to try all the permutations of square roots and factorials.</p>

<p>If we apply up to <code>s</code> times square root on each possible term (i.e. the <code>n</code> initial numbers and the <code>n-1</code> results of binary operations), and up to <code>f</code> times the factorial on each possible term, that gives us a grand total of</p>

<p><code>(n-1)! * k^n * (s+1)^(n+n-1) * (f+1)^(n+n-1)</code></p>

<p>possibilities. It&rsquo;s really good that <code>n</code> is upper-bounded by <code>6</code>&hellip;</p>

<p>To summarize, we can describe a candidate with:</p>

<ul>
<li>a value in the <code>[1,n-1]</code> range, a value in the <code>[1,n-2]</code> range, etc. to code which pair of subsequent operand is used in each of the <code>n-1</code> binary operation,</li>
<li><code>n-1</code> values in the <code>[1,k]</code> range to code the type of each of the <code>n-1</code> binary operations,</li>
<li><code>n</code> values in the <code>[0,s]</code> range to code how many square roots are applied to the <code>n</code> initial values, and <code>n-1</code> more in the <code>[0,s]</code> range for the square root applications of each result of the binary operations,</li>
<li>similarly, <code>n + n-1</code> values in the <code>[0,f]</code> range for the factorials.</li>
</ul>


<p>They say a picture is worth a thousand word. The ratio may be a little lower with ascii art, but let&rsquo;s illustrate these four list item with the winning candidate, i.e. <code>(1+2)!! + 3!^4 - 5</code>. Its evaluation tree looks like that:</p>

<pre><code>1 ---
     \
      3 - 6 - 720 ----
     /                \
2 ---                  \
                        2016
3 - 6 -----------      /    \
                 \    /      \
                  1296        \
                 /             2011
4 ---------------             /
                             /
                            /
5 --------------------------
</code></pre>

<p>Beautiful. The binary operations (merging branches) are:</p>

<pre><code>      +          ^      +      -
</code></pre>

<p>If <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code> are respectively coded by 1,2,3,4,5, the second list item will be <code>(1,5,1,2)</code>.</p>

<p>The binary operations are applied to the following pair of operands:</p>

<pre><code>      1          3      1      1
</code></pre>

<p>which gives us <code>(1,2,1,1)</code> for the first list item. Note that each of these four numbers have been respectively chosen from <code>[1,2,3,4]</code>, <code>[1,2,3]</code>, <code>[1,2]</code>, <code>[1]</code>, which correspond to <code>[(1,2), (2,6), (6,4), (4,5)]</code>, <code>[(720,6), (6,4), (4,5)]</code>, <code>[(720,1296), (1296,5)]</code>, <code>[(2016,5)]</code>, still respectively. It&rsquo;s all about respect.</p>

<p>No square root is applied on the initial numbers, and no square root is applied on intermediary result either, so the third list item is <code>(0,0,0,0,0)</code> and <code>(0,0,0,0)</code>.</p>

<p>Factorial is applied once on the third initial number (a.k.a. <code>3</code>), and twice on the result of the first operation, which gives <code>(0,0,1,0,0)</code> and <code>(2,0,0,0)</code> for the fourth list item.</p>

<h1>Implementation overview</h1>

<p>For the last three item of the previous list, I wrote <code>ExhaustiveEnumeration</code>, a data structure that basically counts in the base corresponding to the range. For example, if <code>n=5</code> and <code>f = 2</code>, the data structure corresponding to the last item of the previous list will count from <code>000000000</code> to <code>222222222</code> in base <code>3</code>.
For the first item of the list, the same idea of counting in a different base is used, except the base varies with the position. For example, if <code>n=5</code>, the data structure will count from <code>0000</code> to <code>0123</code>. Both data structures simply provide an accessor to the content, and a method that increments the content and notifies whether a full cycle has just been completed.</p>

<p>Using these data structure, I wrote <code>CandidateEnumeration</code>, a class that fully describes a candidate as described in the previous list. It has a search method that evaluates the current candidate, and generates the next until it fits the criteria. To generate the next candidate, it chains the increment methods of the <code>ExhaustiveEnumeration</code>: if one indicates that a full cycle has been completed, it calls the next.</p>

<p>The evaluation method creates an array of the <code>n</code> initial numbers, and applies the operations coded in the <code>ExhaustiveEnumeration</code> members, until the array is reduced to the ultimate result. If an illegal operation (e.g. divide by 0 or negative square root) is detected, the evaluation is aborted.</p>

<p>The rest of the code is basically here only to output the result or the progress. And of course, indices start at 0 rather than at 1 as in the previous section. And the final binary operation is actually the first of the array of the <code>CandidateEnumeration</code>&hellip; Enjoy!</p>

<h1>Code</h1>

<figure class='code'><figcaption><span> (main.cpp)</span> <a href='/_includes/2011-10-25/main.cpp'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &lt;iostream&gt;</span>
</span><span class='line'><span class="cp">#include &lt;cmath&gt;</span>
</span><span class='line'><span class="cp">#include &lt;string&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sstream&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// data structure to count from 0 to UPTO^SIZE in base UPTO+1</span>
</span><span class='line'><span class="c1">// the first FROMINDEX positions remain 0</span>
</span><span class='line'><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SIZE</span><span class="p">,</span> <span class="n">T</span> <span class="n">UPTO</span><span class="p">,</span> <span class="kt">int</span> <span class="n">FROMINDEX</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
</span><span class='line'><span class="k">struct</span> <span class="n">ExhaustiveEnumeration</span> <span class="p">{</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>  <span class="n">ExhaustiveEnumeration</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">SIZE</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">mData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="n">T</span> <span class="n">get</span><span class="p">(</span><span class="kt">int</span> <span class="n">pIndex</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mData</span><span class="p">[</span><span class="n">pIndex</span><span class="p">];</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">bool</span> <span class="n">increment</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">FROMINDEX</span><span class="p">;</span>
</span><span class='line'>      <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">SIZE</span> <span class="o">&amp;&amp;</span> <span class="n">mData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">UPTO</span><span class="p">)</span> <span class="n">mData</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">SIZE</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="o">++</span><span class="n">mData</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">protected</span><span class="o">:</span>
</span><span class='line'>  <span class="n">T</span> <span class="n">mData</span><span class="p">[</span><span class="n">SIZE</span><span class="p">];</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// datastructure to count from 0 to 012..SIZE-1 in &quot;base&quot; 123..SIZE</span>
</span><span class='line'><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="kt">int</span> <span class="n">SIZE</span><span class="o">&gt;</span>
</span><span class='line'><span class="k">struct</span> <span class="n">ExhaustiveEnumerationUpToIndex</span> <span class="p">{</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>  <span class="n">ExhaustiveEnumerationUpToIndex</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">SIZE</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">mData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="n">T</span> <span class="n">get</span><span class="p">(</span><span class="kt">int</span> <span class="n">pIndex</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mData</span><span class="p">[</span><span class="n">pIndex</span><span class="p">];</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">bool</span> <span class="n">increment</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>      <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">SIZE</span> <span class="o">&amp;&amp;</span> <span class="n">mData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">i</span><span class="p">)</span> <span class="n">mData</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">SIZE</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>      <span class="o">++</span><span class="n">mData</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">protected</span><span class="o">:</span>
</span><span class='line'>  <span class="n">T</span> <span class="n">mData</span><span class="p">[</span><span class="n">SIZE</span><span class="p">];</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="k">namespace</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// I&#39;m too lazy to use some kind of BigInt...</span>
</span><span class='line'>  <span class="k">typedef</span> <span class="kt">double</span> <span class="n">Number</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// ...but not enough to hard code factorial</span>
</span><span class='line'>  <span class="k">const</span> <span class="kt">int</span> <span class="n">MAXFACTARG</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span><span class='line'>  <span class="k">const</span> <span class="kt">long</span> <span class="n">factorial</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">MAXFACTARG</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span>
</span><span class='line'>      <span class="mi">720</span><span class="p">,</span><span class="mi">5040</span><span class="p">,</span><span class="mi">40320</span><span class="p">,</span><span class="mi">362880</span><span class="p">,</span><span class="mi">3628800</span><span class="p">,</span>
</span><span class='line'>      <span class="mi">39916800</span><span class="p">,</span> <span class="mi">479001600</span><span class="p">,</span> <span class="mi">6227020800</span><span class="p">,</span> <span class="mi">87178291200</span><span class="p">,</span> <span class="mi">1307674368000</span><span class="p">,</span>
</span><span class='line'>      <span class="mi">20922789888000</span><span class="p">,</span> <span class="mi">355687428096000</span><span class="p">,</span> <span class="mi">6402373705728000</span><span class="p">,</span> <span class="mi">121645100408832000</span><span class="p">,</span>
</span><span class='line'>      <span class="mi">2432902008176640000</span><span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// floating point equality</span>
</span><span class='line'>  <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">equals</span><span class="p">(</span><span class="n">Number</span> <span class="n">a</span><span class="p">,</span> <span class="n">Number</span> <span class="n">b</span><span class="p">,</span> <span class="n">Number</span> <span class="n">epsilon</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">Number</span> <span class="n">tDelta</span> <span class="o">=</span> <span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">epsilon</span> <span class="o">&lt;</span> <span class="n">tDelta</span> <span class="o">&amp;&amp;</span> <span class="n">tDelta</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// test whether a floating point is (clos enough from) an integer</span>
</span><span class='line'>  <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">isInt</span><span class="p">(</span><span class="n">Number</span> <span class="n">a</span><span class="p">,</span> <span class="n">Number</span> <span class="n">epsilon</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">equals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Number</span><span class="o">&gt;</span><span class="p">((</span><span class="kt">long</span><span class="p">)</span> <span class="n">a</span><span class="p">),</span> <span class="n">epsilon</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// n = NOPERANDS, f = MAXFRAC, s = MAXSQRT</span>
</span><span class='line'><span class="k">template</span><span class="o">&lt;</span><span class="kt">int</span> <span class="n">NOPERANDS</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="kt">char</span> <span class="n">MAXFRAC</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="kt">char</span> <span class="n">MAXSQRT</span> <span class="o">=</span> <span class="mi">2</span><span class="o">&gt;</span>
</span><span class='line'><span class="k">class</span> <span class="nc">CandidateEnumeration</span> <span class="p">{</span>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>  <span class="n">CandidateEnumeration</span><span class="p">()</span><span class="o">:</span><span class="n">mPairPositions</span><span class="p">(),</span><span class="n">mOps</span><span class="p">(),</span><span class="n">mFacs</span><span class="p">(),</span><span class="n">mSqrt</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// see decode(EvaluationResult) for a description</span>
</span><span class='line'>  <span class="k">enum</span> <span class="n">EvaluationResult</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">CORRECT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>      <span class="n">DIVISION</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>      <span class="n">FAC_TOO_MUCH</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
</span><span class='line'>      <span class="n">FAC_NON_INT</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
</span><span class='line'>      <span class="n">FAC_TOO_BIG</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
</span><span class='line'>      <span class="n">SQRT</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
</span><span class='line'>      <span class="n">INCORRECT</span> <span class="o">=</span> <span class="mi">64</span><span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// mainly do{evaluateCandidate()} while (generateNextCandidate());</span>
</span><span class='line'>  <span class="c1">// the rest is just progress output</span>
</span><span class='line'>  <span class="c1">// </span>
</span><span class='line'>  <span class="c1">// ALL choose whether all candidates should be tried,</span>
</span><span class='line'>  <span class="c1">// or if the search can be stopped after the first success</span>
</span><span class='line'>  <span class="c1">// </span>
</span><span class='line'>  <span class="c1">// VERBOSITY is the bitwise or combination of the EvaluationResult types</span>
</span><span class='line'>  <span class="c1">// which should be printed</span>
</span><span class='line'>  <span class="k">template</span> <span class="o">&lt;</span><span class="kt">bool</span> <span class="n">ALL</span><span class="p">,</span> <span class="kt">int</span> <span class="n">VERBOSITY</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="kt">void</span> <span class="n">search</span><span class="p">(</span><span class="n">Number</span> <span class="n">expectation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Number</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">EvaluationResult</span> <span class="n">result</span><span class="p">;</span>
</span><span class='line'>      <span class="kt">long</span> <span class="n">tRemaingCandidates</span> <span class="o">=</span> <span class="n">factorial</span><span class="p">[</span><span class="n">NBINOPERATIONS</span><span class="p">]</span>
</span><span class='line'>                        <span class="o">*</span><span class="n">pow</span><span class="p">(</span><span class="n">NBINOPERATIONTYPES</span><span class="p">,</span><span class="n">NBINOPERATIONS</span><span class="p">)</span>
</span><span class='line'>                        <span class="o">*</span><span class="n">pow</span><span class="p">(</span><span class="n">MAXFRAC</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NBINOPERATIONS</span><span class="o">+</span><span class="n">NOPERANDS</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>                        <span class="o">*</span><span class="n">pow</span><span class="p">(</span><span class="n">MAXSQRT</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NBINOPERATIONS</span><span class="o">+</span><span class="n">NOPERANDS</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">tRemaingCandidates</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; candidates&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>      <span class="k">do</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">result</span> <span class="o">=</span> <span class="n">evaluateCandidate</span><span class="p">(</span><span class="n">expectation</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">);</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&amp;</span> <span class="n">VERBOSITY</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">decode</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="n">printCandidate</span><span class="p">();</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="o">--</span><span class="n">tRemaingCandidates</span><span class="p">;</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="n">ALL</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">tRemaingCandidates</span><span class="o">%</span><span class="mi">100000000</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">tRemaingCandidates</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; remaining candidates&quot;</span>
</span><span class='line'>                      <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">generateNextCandidate</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">ALL</span> <span class="o">||</span> <span class="n">result</span> <span class="o">!=</span> <span class="n">CORRECT</span><span class="p">));</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kt">void</span> <span class="n">printCandidate</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">tCandidate</span><span class="p">[</span><span class="n">NOPERANDS</span><span class="p">];</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NOPERANDS</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">tOperand</span><span class="p">;</span>
</span><span class='line'>          <span class="n">tOperand</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>          <span class="n">tCandidate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">buildNode</span><span class="p">(</span><span class="n">tOperand</span><span class="p">.</span><span class="n">str</span><span class="p">(),</span>
</span><span class='line'>                  <span class="n">mSqrt</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">mFacs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">NBINOPERATIONS</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kt">int</span> <span class="n">tPairPositionIndex</span> <span class="o">=</span> <span class="n">mPairPositions</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span><span class='line'>          <span class="n">tCandidate</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;(&#39;</span>
</span><span class='line'>                  <span class="o">+</span> <span class="n">tCandidate</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span>
</span><span class='line'>                  <span class="o">+</span> <span class="n">decode</span><span class="p">(</span><span class="n">mOps</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span><span class='line'>                  <span class="o">+</span> <span class="n">tCandidate</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="sc">&#39;)&#39;</span><span class="p">;</span>
</span><span class='line'>          <span class="n">tCandidate</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">buildNode</span><span class="p">(</span>
</span><span class='line'>                  <span class="n">tCandidate</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">],</span>
</span><span class='line'>                  <span class="n">mSqrt</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">NOPERANDS</span><span class="o">+</span><span class="n">i</span><span class="p">),</span> <span class="n">mFacs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">NOPERANDS</span><span class="o">+</span><span class="n">i</span><span class="p">));</span>
</span><span class='line'>          <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">tPairPositionIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">NBINOPERATIONS</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">tCandidate</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tCandidate</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">tCandidate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// helper of printCandidate()</span>
</span><span class='line'>  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">buildNode</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">pCore</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pNSqrt</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pNFac</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">pNSqrt</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">pCore</span> <span class="o">=</span> <span class="sc">&#39;(&#39;</span><span class="o">+</span><span class="n">pCore</span><span class="o">+</span><span class="sc">&#39;)&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">pNSqrt</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="n">pCore</span><span class="o">=</span><span class="s">&quot;√&quot;</span><span class="o">+</span><span class="n">pCore</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">pNFac</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">pCore</span> <span class="o">=</span> <span class="sc">&#39;(&#39;</span><span class="o">+</span><span class="n">pCore</span><span class="o">+</span><span class="sc">&#39;)&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">pNFac</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="n">pCore</span><span class="o">+=</span><span class="sc">&#39;!&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">pCore</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">protected</span><span class="o">:</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// decode the current candidate and check whether it&#39;s the expected result</span>
</span><span class='line'>  <span class="c1">// or abort if an operation is not possible</span>
</span><span class='line'>  <span class="n">EvaluationResult</span> <span class="n">evaluateCandidate</span><span class="p">(</span>
</span><span class='line'>          <span class="n">Number</span> <span class="n">expectation</span><span class="p">,</span> <span class="k">const</span> <span class="n">Number</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// initial numbers and corresponding factorials and square roots</span>
</span><span class='line'>      <span class="n">Number</span> <span class="n">tResults</span><span class="p">[</span><span class="n">NOPERANDS</span><span class="p">];</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">NOPERANDS</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">tResults</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">mSqrt</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="n">tResults</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">tResults</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">mFacs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="n">tResults</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">MAXFACTARG</span><span class="p">)</span> <span class="k">return</span> <span class="n">FAC_TOO_MUCH</span><span class="p">;</span>
</span><span class='line'>              <span class="n">tResults</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">factorial</span><span class="p">[(</span><span class="kt">int</span><span class="p">)</span> <span class="n">tResults</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// fetch the operation type and operand pair, compute result</span>
</span><span class='line'>      <span class="c1">// and apply corresponding factorials and square roots</span>
</span><span class='line'>      <span class="c1">// </span>
</span><span class='line'>      <span class="c1">// the result is stored in the cell of the first operand,</span>
</span><span class='line'>      <span class="c1">// and the intermediary results after the second operand are shifted</span>
</span><span class='line'>      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">NBINOPERATIONS</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">// binary operation</span>
</span><span class='line'>          <span class="kt">int</span> <span class="n">tPairPositionIndex</span> <span class="o">=</span> <span class="n">mPairPositions</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span><span class='line'>          <span class="k">switch</span> <span class="p">(</span><span class="n">mOps</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">+=</span>
</span><span class='line'>                      <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">-=</span>
</span><span class='line'>                      <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">*=</span>
</span><span class='line'>                      <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">/=</span>
</span><span class='line'>                      <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="k">case</span> <span class="mi">4</span><span class="o">:</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">=</span>
</span><span class='line'>                      <span class="n">pow</span><span class="p">(</span><span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">],</span>
</span><span class='line'>                              <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>              <span class="k">default</span><span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Unexpected opcode:&quot;</span>
</span><span class='line'>                      <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">mOps</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">isnan</span><span class="p">(</span><span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">])</span>
</span><span class='line'>              <span class="o">||</span> <span class="n">std</span><span class="o">::</span><span class="n">isinf</span><span class="p">(</span><span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]))</span> <span class="k">return</span> <span class="n">DIVISION</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">// square roots</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="n">mSqrt</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">NOPERANDS</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span class='line'>                  <span class="o">&amp;&amp;</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">return</span> <span class="n">SQRT</span><span class="p">;</span>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">mSqrt</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">NOPERANDS</span><span class="o">+</span><span class="n">i</span><span class="p">);</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">=</span>
</span><span class='line'>                      <span class="n">sqrt</span><span class="p">(</span><span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">// factorial</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="n">mFacs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">NOPERANDS</span><span class="o">+</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span class='line'>                  <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">isInt</span><span class="p">(</span><span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">],</span> <span class="n">epsilon</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">return</span> <span class="n">FAC_NON_INT</span><span class="p">;</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">mFacs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">NOPERANDS</span><span class="o">+</span><span class="n">i</span><span class="p">);</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&gt;</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span>
</span><span class='line'>                  <span class="o">||</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">MAXFACTARG</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="k">return</span> <span class="n">FAC_TOO_BIG</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]</span> <span class="o">=</span>
</span><span class='line'>                      <span class="n">factorial</span><span class="p">[(</span><span class="kt">int</span><span class="p">)</span> <span class="n">tResults</span><span class="p">[</span><span class="n">tPairPositionIndex</span><span class="p">]];</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1">// shifting the intermediate results</span>
</span><span class='line'>          <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">tPairPositionIndex</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">NBINOPERATIONS</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="n">tResults</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tResults</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="n">equals</span><span class="p">(</span><span class="n">tResults</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">expectation</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span><span class="o">?</span><span class="nl">CORRECT:</span><span class="n">INCORRECT</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// chains the increments</span>
</span><span class='line'>  <span class="kt">bool</span> <span class="n">generateNextCandidate</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">mOps</span><span class="p">.</span><span class="n">increment</span><span class="p">()</span>
</span><span class='line'>              <span class="o">||</span> <span class="n">mPairPositions</span><span class="p">.</span><span class="n">increment</span><span class="p">()</span>
</span><span class='line'>              <span class="o">||</span> <span class="n">mFacs</span><span class="p">.</span><span class="n">increment</span><span class="p">()</span>
</span><span class='line'>              <span class="o">||</span> <span class="n">mSqrt</span><span class="p">.</span><span class="n">increment</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// opcode to char</span>
</span><span class='line'>  <span class="k">static</span> <span class="kt">char</span> <span class="n">decode</span><span class="p">(</span><span class="kt">char</span> <span class="n">op</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">switch</span> <span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="k">return</span> <span class="sc">&#39;+&#39;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">return</span> <span class="sc">&#39;-&#39;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">return</span> <span class="sc">&#39;*&#39;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="k">return</span> <span class="sc">&#39;/&#39;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">case</span> <span class="mi">4</span><span class="o">:</span> <span class="k">return</span> <span class="sc">&#39;^&#39;</span><span class="p">;</span>
</span><span class='line'>          <span class="k">default</span><span class="o">:</span> <span class="k">return</span> <span class="sc">&#39;?&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// describes an EvaluationResult</span>
</span><span class='line'>  <span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">decode</span><span class="p">(</span><span class="n">EvaluationResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">switch</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">case</span> <span class="nl">CORRECT:</span>
</span><span class='line'>          <span class="k">return</span> <span class="s">&quot;Solution found&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">case</span> <span class="nl">DIVISION:</span>
</span><span class='line'>          <span class="k">return</span> <span class="s">&quot;Division impossible to perform on an operator&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">case</span> <span class="nl">FAC_TOO_MUCH:</span>
</span><span class='line'>          <span class="k">return</span> <span class="s">&quot;Factorial impossible to perform on a base operand&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">case</span> <span class="nl">FAC_NON_INT:</span>
</span><span class='line'>          <span class="k">return</span> <span class="s">&quot;Factorial impossible to perform on non integer&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">case</span> <span class="nl">FAC_TOO_BIG:</span>
</span><span class='line'>          <span class="k">return</span> <span class="s">&quot;Factorial impossible to perform on an operation result&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">case</span> <span class="nl">SQRT:</span>
</span><span class='line'>          <span class="k">return</span> <span class="s">&quot;Square root impossible to perform&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">case</span> <span class="nl">INCORRECT:</span>
</span><span class='line'>          <span class="k">return</span> <span class="s">&quot;Invalid candidate&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">default</span><span class="o">:</span>
</span><span class='line'>          <span class="k">return</span> <span class="s">&quot;Unexpected result code&quot;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// count of binary operations (n-1)</span>
</span><span class='line'>  <span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">NBINOPERATIONS</span> <span class="o">=</span> <span class="n">NOPERANDS</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="c1">// count of types of binary operations (k)</span>
</span><span class='line'>  <span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">NBINOPERATIONTYPES</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// position of the pair of operands of each binary operation</span>
</span><span class='line'>  <span class="n">ExhaustiveEnumerationUpToIndex</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="n">NBINOPERATIONS</span><span class="o">&gt;</span> <span class="n">mPairPositions</span><span class="p">;</span>
</span><span class='line'>  <span class="c1">// type of each binary operation</span>
</span><span class='line'>  <span class="n">ExhaustiveEnumeration</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="n">NBINOPERATIONS</span><span class="p">,</span> <span class="n">NBINOPERATIONTYPES</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;</span> <span class="n">mOps</span><span class="p">;</span>
</span><span class='line'>  <span class="c1">// count of factorials to apply on each initial number or operation result</span>
</span><span class='line'>  <span class="c1">// it&#39;s useless to try to increase the count of factorials applied to 1 and</span>
</span><span class='line'>  <span class="c1">// 2, so we skip the first 2 indices in the enumeration</span>
</span><span class='line'>  <span class="n">ExhaustiveEnumeration</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="n">NOPERANDS</span><span class="o">+</span><span class="n">NBINOPERATIONS</span><span class="p">,</span> <span class="n">MAXFRAC</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">mFacs</span><span class="p">;</span>
</span><span class='line'>  <span class="c1">// count of square roots to apply on each initial number or operation result</span>
</span><span class='line'>  <span class="c1">// it&#39;s useless to try to increase the count of square root applied to 1</span>
</span><span class='line'>  <span class="c1">// so we skip the first  index in the enumeration</span>
</span><span class='line'>  <span class="n">ExhaustiveEnumeration</span><span class="o">&lt;</span><span class="kt">char</span><span class="p">,</span> <span class="n">NOPERANDS</span><span class="o">+</span><span class="n">NBINOPERATIONS</span><span class="p">,</span> <span class="n">MAXSQRT</span><span class="p">,</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">mSqrt</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">typedef</span> <span class="n">CandidateEnumeration</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span> <span class="n">Candidates</span><span class="p">;</span>
</span><span class='line'>  <span class="n">Candidates</span> <span class="n">tCandidates</span><span class="p">;</span>
</span><span class='line'>  <span class="n">tCandidates</span><span class="p">.</span><span class="n">search</span><span class="o">&lt;</span><span class="kc">true</span><span class="p">,</span> <span class="n">Candidates</span><span class="o">::</span><span class="n">CORRECT</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">2011</span><span class="p">);</span>
</span><span class='line'>  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Done&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h1>Limitations</h1>

<p>The main limitation of this code is that the number representation (<code>long</code>) does not allow to compute the factorial of numbers above 20, which aborts the computation of potentially correct candidates. The use of <code>double</code> also results in false positive due to rounding errors.</p>

<p>The limitation to this brute force algorithm in general is that there is obviously no end in the increase of the number of application of factorial and square root. I can&rsquo;t think of an upper bound on <code>f</code> and <code>s</code> after which there is no possible solution any more.</p>

<p>That and the lack of interleaved factorials and square roots leaves the door open to solutions with less than 5 initial numbers. I would bet that there aren&rsquo;t any, but I&rsquo;m not sure how to prove it.</p>

<p>Finally, this code can easily be used to play &ldquo;The answer is 2012&rdquo;. I wonder if there are years for which this code is unacceptably long, i.e. years that would require &ldquo;a lot&rdquo; of initial numbers&hellip;</p>

<h1>Comments</h1>

<p>I posted this <a href="http://news.ycombinator.com/item?id=3162663">story on HackerNews</a> and got some interesting feedbacks.</p>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard">Posted by <span class="fn">Quentin Bonnard</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2011-10-25T00:00:00+02:00" pubdate data-updated="true"></time>
          


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://quentin.bonnard.eu/blog/2011/10/25/The_answer_is_2011_the_question_can_be_brute_force/" data-via="" data-counturl="http://quentin.bonnard.eu/blog/2011/10/25/The_answer_is_2011_the_question_can_be_brute_force/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2011/07/29/Headless_SparkleShare_on_the_host/" title="Previous Post: Headless SparkleShare on the host">&laquo; Headless SparkleShare on the host</a></li>
            
            
            <li class="next"><a href="/blog/2011/12/18/Reverse_Literate_Programming_on_Jekyll-GitHub/" title="Next Post: (Reverse) Literate Programming on Jekyll/Github">(Reverse) Literate Programming on Jekyll/Github &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
  </div>
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2010-2015 - Quentin Bonnard<br>
  <small>
      <span class="credit">Powered by <a target="_blank" href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a target="_blank" href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    <script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>




<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-26532340-2']);
  _gaq.push(['_setDomainName', 'bonnard.eu']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


  </body>
</html>
